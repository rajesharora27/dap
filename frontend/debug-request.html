<!DOCTYPE html>
<html>

<head>
    <title>Debug Frontend Request</title>
</head>

<body>
    <h1>Frontend Request Debug</h1>
    <button onclick="testProductUpdate()">Test Product Update</button>
    <div id="result"></div>

    <script>
        async function testProductUpdate() {
            const result = document.getElementById('result');
            result.innerHTML = 'Testing...';

            try {
                console.log('Making request to http://localhost:4000/graphql');

                const response = await fetch('http://localhost:4000/graphql', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Accept': 'application/json',
                        'authorization': 'admin'
                    },
                    body: JSON.stringify({
                        query: `
                            mutation UpdateProduct($id: ID!, $input: ProductInput!) {
                                updateProduct(id: $id, input: $input) {
                                    id
                                    name
                                    description
                                    statusPercent
                                    customAttrs
                                }
                            }
                        `,
                        variables: {
                            id: "cmfr27qjk00a5b2iadziqhw0i",
                            input: {
                                name: "Test Frontend Debug",
                                description: "Testing frontend debug",
                                customAttrs: {
                                    priority: "high",
                                    status: "frontend-debug"
                                }
                            }
                        }
                    })
                });

                console.log('Response status:', response.status);
                console.log('Response headers:', [...response.headers.entries()]);

                const data = await response.json();
                console.log('Response data:', data);

                if (response.ok) {
                    result.innerHTML = `<pre style="color: green;">SUCCESS:\n${JSON.stringify(data, null, 2)}</pre>`;
                } else {
                    result.innerHTML = `<pre style="color: red;">ERROR ${response.status}:\n${JSON.stringify(data, null, 2)}</pre>`;
                }

            } catch (error) {
                console.error('Request failed:', error);
                result.innerHTML = `<pre style="color: red;">FETCH ERROR: ${error.message}</pre>`;
            }
        }
    </script>
</body>

</html>
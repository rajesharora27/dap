<!DOCTYPE html>
<html>

<head>
    <title>Test Product Update</title>
    <script src="https://unpkg.com/apollo-client@3.7.17/apollo-client.min.js"></script>
    <script src="https://unpkg.com/graphql@16.6.0/graphql.min.js"></script>
</head>

<body>
    <h1>Product Update Test</h1>
    <div id="result"></div>

    <script>
        async function testProductUpdate() {
            try {
                const response = await fetch('http://localhost:4000/graphql', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        query: `
                            mutation UpdateProduct($id: ID!, $input: ProductInput!) {
                                updateProduct(id: $id, input: $input) {
                                    id
                                    name
                                    description
                                    statusPercent
                                    customAttrs
                                }
                            }
                        `,
                        variables: {
                            id: "cmfr27qjk00a5b2iadziqhw0i",
                            input: {
                                name: "Test Product JS",
                                description: "Updated via JavaScript",
                                customAttrs: {
                                    priority: "high",
                                    test: "frontend-test"
                                }
                            }
                        }
                    })
                });

                const data = await response.json();

                if (data.errors) {
                    document.getElementById('result').innerHTML = `<pre style="color: red;">${JSON.stringify(data.errors, null, 2)}</pre>`;
                } else {
                    document.getElementById('result').innerHTML = `<pre style="color: green;">SUCCESS:\n${JSON.stringify(data, null, 2)}</pre>`;
                }

                console.log('Response status:', response.status);
                console.log('Response data:', data);

            } catch (error) {
                document.getElementById('result').innerHTML = `<pre style="color: red;">ERROR: ${error.message}</pre>`;
                console.error('Test failed:', error);
            }
        }

        // Run test on page load
        testProductUpdate();
    </script>
</body>

</html>